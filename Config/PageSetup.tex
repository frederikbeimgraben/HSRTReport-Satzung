% !TEX root = ../HSRTReport.cls
% ==============================================================================
% Page Setup Configuration Module
% ==============================================================================
% Description: Page layout configuration including headers, footers, and styling
% Author: Frederik Beimgraben
% License: Creative Commons CC BY 4.0
% ==============================================================================

% ==============================================================================
% Required Packages
% ==============================================================================
\RequirePackage{fancyhdr}
\RequirePackage{ifthen}
\RequirePackage{xcolor}
\RequirePackage{etoolbox}

% ==============================================================================
% Page Style Configuration
% ==============================================================================
% Use fancy page style for headers and footers
\pagestyle{fancy}

\renewcommand{\headrulewidth}{0pt}

% Override KOMA-Script chapter page style to use fancy instead of plain
\renewcommand{\chapterpagestyle}{fancy}

% ==============================================================================
% Page Number Configuration
% ==============================================================================
% Set page number font style
\setkomafont{pagenumber}{\color{gray}\blenderfont\selectfont}

% Adjust footer position - move up by reducing footskip
\setlength{\footskip}{25pt}  % Reduced from default to move footer up

% ==============================================================================
% Header and Footer Setup
% ==============================================================================
\fancyhf{}

\AtEndDocument{
  \immediate\write\@auxout{\string\gdef\string\@lastpage{\thepage}}
}

% ------------------------------------------------------------------------------
% Header and Footer Configuration
% ------------------------------------------------------------------------------
% Left header: Chapter number and title
% Right header: Document title
% Left footer: Author and module name
% Center footer: Page number
\def\hffont{\color{gray}\blenderfont}

\newcommand{\fancyfootL}{
  \hffont
  \vspace{-1.25em}
  \def\arraystretch{1}
  \begin{tabular}{l}
    \@author \\
    \ifdef{\modulename}{\modulename}{Modul-Name}
  \end{tabular}
}

\newcommand{\fancyfootC}{
  \hffont
	Seite~\thepage~von~\@ifundefined{@lastpage}{??}{\@lastpage}
}

\newcommand{\fancyheadR}{
  \hffont
  \ifnum\value{chapter}>0\relax
    \thechapter~â€“~\leftmark
	\fi%
}

\newcommand{\fancyheadL}{
  \hffont
	\@title
}

\newcommand{\applyhfstyles}{
  \fancyhead[R]{
    \fancyheadR
  }
  \fancyhead[L]{
    \fancyheadL
  }
  \fancyfoot[C]{
    \fancyfootC
  }
  \fancyfoot[L]{
    \fancyfootL
  }
}

\newcommand{\footerhorizspacing}{\qquad}

% Apply Styles
\applyhfstyles

% Update chapter marks to show only chapter name without "Chapter" prefix
\renewcommand{\chaptermark}[1]{\markboth{#1}{}}
\renewcommand{\sectionmark}[1]{}

% ==============================================================================
% Plain Page Style (for chapter pages)
% ==============================================================================
% Define the plain page style (used on chapter start pages)
\fancypagestyle{plain}{%
	\fancyhf{}%
	\applyhfstyles
	\renewcommand{\headrulewidth}{0pt}
}

% ==============================================================================
% Fancy Page Style Definition
% ==============================================================================
% Explicitly define the fancy page style
\fancypagestyle{fancy}{%
	\fancyhf{}%
	\applyhfstyles
}

% ==============================================================================
% Override Default Page Styles
% ==============================================================================
% Ensure all special pages use fancy style
\AtBeginDocument{%
	\pagestyle{fancy}%
	\renewcommand{\chapterpagestyle}{fancy}%
}

% ==============================================================================
% End of Page Setup Module
% ==============================================================================
